/* CVE-2022-44707 PoC code
 * Copyright 2023 Akamai Technologies, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in
 * compliance with the License.  You may obtain a copy
 * of the License at
 *
 *   https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in
 * writing, software distributed under the License is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
 * CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing
 * permissions and limitations under the License.
 */
 
typedef unsigned char BYTE;
typedef BYTE BOOLEAN, * PBOOLEAN;
typedef struct _REG_UNICODE_STRING {
    unsigned short Length;
    unsigned short MaximumLength;
    [size_is(MaximumLength / 2), length_is((Length) / 2)] unsigned short* Buffer;
}REG_UNICODE_STRING, * PREG_UNICODE_STRING;
[
    uuid(d95afe70-a6d5-4259-822e-2c84da1ddb0d),
    pointer_default(unique),
    version(1.0)
]
interface WindowsShutdown
{
    unsigned long
        WsdrInitiateShutdown(
            [in] handle_t Binding,
            [in, unique] PREG_UNICODE_STRING lpMessage,
            [in] unsigned long dwGracePeriod,
            [in] unsigned long dwShudownFlags,
            [in] unsigned long dwReason,
            [in, unique] PREG_UNICODE_STRING lpClientHint
        );

    unsigned long
        WsdrAbortShutdown(
            [in] handle_t Binding,
            [in, unique] PREG_UNICODE_STRING lpClientHint
        );

    unsigned long
        WsdrCheckForHiberboot(
            [in] handle_t Binding,
            [in, out] BOOLEAN* hiberbootStatus,
            [in] BOOLEAN  changeStatus,
            [in, string, unique] wchar_t* something
        );
}